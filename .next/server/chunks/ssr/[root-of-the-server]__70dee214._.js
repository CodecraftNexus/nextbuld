module.exports=[72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},27395,a=>{"use strict";let b="https://prediction.medi.lk",c=!1,d=[],e=(a,b=null)=>{d.forEach(c=>{a?c.reject(a):c.resolve(b)}),d=[]},f=async(a,f)=>{let g=await fetch(`${b}${a}`,{...f,credentials:"include",headers:{"Content-Type":"application/json",...f?.headers||{}}});if(401===g.status){if(c)return new Promise((a,b)=>{d.push({resolve:a,reject:b})}).then(c=>fetch(`${b}${a}`,{...f,headers:{...f?.headers,Authorization:`Bearer ${c}`}})).catch(a=>Promise.reject(a));c=!0;try{let c=await fetch(`${b}/api/auth/refresh`,{method:"POST",credentials:"include"});if(!c.ok)throw Error("Refresh failed");let d=await c.json(),g=d.access_token||d.accessToken;e(null,g);let h={...f,headers:{...f?.headers,Authorization:`Bearer ${g}`}};return fetch(`${b}${a}`,h)}catch(a){return e(a,null),Promise.reject(a)}finally{c=!1}}return g};a.s(["apiClient",0,{get:async(a,b)=>{let c=await f(a,{...b,method:"GET"}),d=await c.json();if(!c.ok)throw d;return d},post:async(a,b,c)=>{let d=await f(a,{...c,method:"POST",body:b?JSON.stringify(b):void 0}),e=await d.json();if(!d.ok)throw e;return e},put:async(a,b,c)=>{let d=await f(a,{...c,method:"PUT",body:b?JSON.stringify(b):void 0}),e=await d.json();if(!d.ok)throw e;return e},delete:async(a,b)=>{let c=await f(a,{...b,method:"DELETE"}),d=await c.json();if(!c.ok)throw d;return d}}])},10918,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(20094),f=a.i(27395);let g=async a=>{try{let b=a?`/api/profile?id=${a}`:"/api/profile",c=await f.apiClient.get(b);return{success:!0,user:c}}catch(a){return{success:!1,error:a.message}}},h=async a=>await f.apiClient.post("/api/auth/login",a),i=async a=>await f.apiClient.post("/api/auth/register",a),j=async a=>await f.apiClient.put("/api/profile",a),k=async()=>{try{await f.apiClient.post("/api/auth/logout")}catch(a){throw console.error("Logout error:",a),a}},l=async()=>{try{let a=await f.apiClient.post("/api/planethouse");return{success:!0,palentData:a}}catch(a){return{success:!1,error:a.message}}},m=async()=>{try{let a=await f.apiClient.post("/api/mahadasha");return{success:!0,MahadashaData:a}}catch(a){return{success:!1,error:a.message}}},n=async()=>{try{let a=await f.apiClient.post("/api/anthardasha");return{success:!0,AnthardashaData:a}}catch(a){return{success:!1,error:a.message}}},o=async a=>{try{let b=await f.apiClient.post("/api/auth/google-login",{idToken:a}),c=b?.requiresUsername;return{success:!0,user:b,requiresUsername:c}}catch(a){return{success:!1,error:a.message}}},p=async a=>{try{let b=await f.apiClient.post(`/api/prediction/${a}`);return{success:!0,predictions:b}}catch(a){return{success:!1,error:a.message}}},q=async()=>{try{let a=await f.apiClient.get("/api/jobs/options");return{success:!0,options:a}}catch(a){return{success:!1,error:a.message}}},r=async()=>{try{let a=await f.apiClient.get("/api/education/options");return{success:!0,options:a}}catch(a){return{success:!1,error:a.message}}},s=async a=>{try{let b=await f.apiClient.post("/api/profile/switch",{profileId:a});return b.token&&localStorage.setItem("auth_token",b.token),{success:!0,data:b}}catch(a){return console.error("Profile switch failed:",a),{success:!1,error:a.message}}},t=async(a,b)=>{try{let c=await f.apiClient.post("/api/addProfile",{name:a,nikname:b});return{success:!0,data:c}}catch(a){return console.error("Add profile failed:",a),{success:!1,error:a.message}}},u=async()=>{try{let a=await f.apiClient.post("/api/navam");return{success:!0,navamData:a}}catch(a){return{success:!1,error:a.message}}},v=async()=>{try{let a=await f.apiClient.post("/api/astrologic");return{success:!0,AstroData:a}}catch(a){return{success:!1,error:a.message}}},w=async()=>{try{let a=await f.apiClient.get("/api/subscription/packages");return{success:!0,packages:a}}catch(a){return{success:!1,error:a.message}}},x=async()=>{try{let a=await f.apiClient.get("/api/subscription/current");return{success:!0,subscription:a}}catch(a){return{success:!1,error:a.message}}},y=async(a,b)=>{try{let c=await f.apiClient.post("/api/subscription/initiate",{packageId:a,duration:b});return{success:!0,...c}}catch(a){return{success:!1,error:a.message}}},z=async(a,b,c,d)=>{try{let e=await f.apiClient.post("/api/userfeedback",{planet:a,text:b,cat:c,status:d});return{success:!0,result:e}}catch(a){return{success:!1,error:a.message}}},A=async()=>{try{let a=await f.apiClient.get("/api/feedback/status");return{success:!0,result:a}}catch(a){return{success:!1,error:a.message}}},B=async()=>{try{let a=await f.apiClient.get("/api/survey/questions");return{success:!0,questions:a}}catch(a){return{success:!1,error:a.message}}},C=async()=>{try{let a=await f.apiClient.get("/api/survey/answers");return{success:!0,answers:a}}catch(a){return{success:!1,error:a.message}}},D=async a=>{try{let b=await f.apiClient.post("/api/survey/answers",{answers:a});return{success:!0,data:b}}catch(a){return{success:!1,error:a.message}}},E=async()=>{try{let a=await f.apiClient.get("/api/survey/deceased-family");return{success:!0,members:a}}catch(a){return{success:!1,error:a.message}}},F=async a=>{try{let b=await f.apiClient.post("/api/survey/deceased-family",{members:a});return{success:!0,data:b}}catch(a){return{success:!1,error:a.message}}},G=async()=>{try{let a=await f.apiClient.get("/api/survey/status");return{success:!0,result:a}}catch(a){return{success:!1,error:a.message}}},H=async a=>{try{let b=await f.apiClient.delete(`/api/survey/deceased-family/${a}`);return{success:!0,data:b}}catch(a){return{success:!1,error:a.message}}},I=(0,c.createContext)(void 0);a.s(["AuthProvider",0,({children:a})=>{let f=(0,d.useRouter)(),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)(null),[N,O]=(0,c.useState)(null),[P,Q]=(0,c.useState)(null),[R,S]=(0,c.useState)({}),[T,U]=(0,c.useState)(null),[V,W]=(0,c.useState)(null),[X,Y]=(0,c.useState)(null),[Z,$]=(0,c.useState)(!0),[_,aa]=(0,c.useState)({}),[ab,ac]=(0,c.useState)(null),ad=(0,c.useRef)(!1),ae=(0,c.useRef)(0),af=()=>aa({}),ag=(0,c.useCallback)(async()=>{try{await ay(),await Promise.allSettled([l().then(a=>{a.success&&M(a.palentData)}),u().then(a=>{a.success&&O(a.navamData)}),m().then(a=>{a.success&&U(a.MahadashaData)}),n().then(a=>{a.success&&W(a.AnthardashaData)})])}catch(a){console.error("Error fetching all data:",a)}},[]),ah=(0,c.useCallback)(async a=>{let b=Date.now();if(ad.current)return void console.log("Auth check already in progress, skipping...");if(b-ae.current<500)return void console.log("Auth check debounced");ad.current=!0,ae.current=b,$(!0);try{let b=await g(a);b.success&&b.user?(K(b.user),Y(!0),await ag()):(K(null),Y(!1),M(null),O(null),U(null),W(null),S({}))}catch(a){K(null),Y(!1),M(null),O(null),U(null),W(null),S({})}finally{$(!1),ad.current=!1}},[ag]),ai=(0,c.useCallback)(async a=>{if(!a)return void e.toast.error("Invalid profile ID");$(!0);try{let b=await s(a);if(b.success)await ah(),e.toast.success("Profile switched successfully");else throw Error(b.error||"Failed to switch profile")}catch(a){throw console.error("Profile switch error:",a),e.toast.error(a.message||"Failed to switch profile"),a}finally{$(!1)}},[ah]),aj=(0,c.useCallback)(async(a,b)=>{if(!a||!b)return void e.toast.error("Name and nickname are required");$(!0);try{let c=await t(a,b);if(c.success)await ah(),e.toast.success("Profile added successfully");else throw Error(c.error||"Failed to add profile")}catch(a){throw console.error("Add profile error:",a),e.toast.error(a.message||"Failed to add profile"),a}finally{$(!1)}},[ah]),ak=(0,c.useCallback)(async()=>{if(X){$(!0);try{await ag()}finally{$(!1)}}},[X,ag]);(0,c.useEffect)(()=>{ah(),af()},[]),(0,c.useEffect)(()=>{let a,b=()=>{X&&!ad.current&&(a=setTimeout(()=>{ah()},5e3))};return window.addEventListener("focus",b),()=>{window.removeEventListener("focus",b),clearTimeout(a)}},[X]);let al=async a=>{af(),$(!0);try{await h(a),await ah(),e.toast.success("Login Successful!"),f.push("/")}catch(b){let a=b.message||"Login failed. Please try again.";throw aa({general:a}),e.toast.error(a),b}finally{$(!1)}},am=async a=>{af(),$(!0);try{await j(a),await ah(),e.toast.success("Profile updated successfully")}catch(a){if(a.errors&&"object"==typeof a.errors)aa(a.errors);else{let b=a.message||"Profile update failed";aa({general:b}),e.toast.error(b)}throw a}finally{$(!1)}},an=async a=>{af(),$(!0);try{await i(a),e.toast.success("Account Created Successfully!")}catch(a){if(a.errors&&"object"==typeof a.errors)aa(a.errors);else{let b=a.message||"Registration failed";aa({general:b}),e.toast.error(b)}throw a}finally{$(!1)}},ao=async()=>{try{await k(),K(null),M(null),O(null),U(null),W(null),S({}),Y(!1),e.toast.info("Logged out successfully"),f.push("/auth")}catch(a){e.toast.error("Logout failed")}},ap=async()=>{try{$(!0);let a=await l();a.success?M(a.palentData):M(null)}catch(a){throw M(null),a}finally{$(!1)}},aq=async()=>{try{$(!0);let a=await m();a.success?U(a.MahadashaData):U(null)}catch(a){throw U(null),a}finally{$(!1)}},ar=async()=>{try{$(!0);let a=await n();a.success?W(a.AnthardashaData):W(null)}catch(a){throw W(null),a}finally{$(!1)}},as=async a=>{$(!0),aa({});try{let b=await o(a);if(b.requiresUsername)return{success:!0,requiresUsername:!0,user:b.user};return K(b?.user),await ah(),{success:!0,requiresUsername:!1,user:b.user}}catch(a){throw aa({general:a?.message||"Google login failed"}),a}finally{$(!1)}},at=async a=>{try{let b=await p(a);S(c=>({...c,[a]:b.predictions}))}catch(a){return{success:!1,error:a.message}}},au=async()=>{try{let a=await q();if(a.success)return a.options;throw Error(a.error)}catch(a){throw a}},av=async()=>{try{let a=await r();if(a.success)return a.options;throw Error(a.error)}catch(a){throw a}},aw=async()=>{try{$(!0);let a=await u();a.success?O(a.navamData):O(null)}catch(a){throw O(null),a}finally{$(!1)}},ax=async()=>{try{$(!0);let a=await v();a.success?Q(a.AstroData):Q(null)}catch(a){throw Q(null),a}finally{$(!1)}},ay=async()=>{try{let a=await x();if(a.success)return ac(a.subscription),a.subscription;return null}catch(a){return console.error("getCurrentSubscription error:",a),null}},az=async()=>{try{let a=await w();if(a.success)return a.packages}catch(a){console.error("getSubscriptionPackages error:",a)}},aA=async(a,b)=>{try{let c=await y(a,b);if(c.success){let a=document.createElement("form");a.method="POST",a.action=c.payUrl,Object.entries(c.payData).forEach(([b,c])=>{let d=document.createElement("input");d.type="hidden",d.name=b,d.value=c,a.appendChild(d)}),document.body.appendChild(a),a.submit(),document.body.removeChild(a)}else throw Error(c.error)}catch(a){throw console.error("initiateSubscriptionPayment error:",a),a}},aB=async(a,b,c,d)=>{try{let f=await z(a,b,c,d);if(!0==f.success)return e.toast.success("Feedback set successfull"),f.result}catch(a){e.toast.error("Feedback set error"),console.error("HandleFeedback error:",a)}},aC=async()=>{try{let a=await A();if(!0==a.success)return a.result}catch(a){console.error(" GetFeedbackStatus error:",a)}},aD=async()=>{try{let a=await B();if(!0==a.success)return a.questions}catch(a){console.error("GetSurveyQuestions  error",a)}},aE=async()=>{try{let a=await C();if(!0==a.success)return a.answers}catch(a){console.error("GetUserSurveyAnswers error",a)}},aF=async a=>{try{let b=await D(a);if(!0==b.success)return e.toast.success("Answers Seve Successfull"),b.data}catch(a){console.error("SaveSurveyAnswers error",a)}},aG=async()=>{try{let a=await E();if(!0==a.success)return a.members}catch(a){console.error("GetDeceasedFamily error",a)}},aH=async a=>{try{let b=await F(a);if(!0==b.success)return b.data}catch(a){console.error("SaveDeceasedFamily error",a)}},aI=async()=>{try{let a=await G();if(!0==a.success)return a.result}catch(a){console.error("GetSurveyStatus error",a)}},aJ=async a=>{try{let b=await H(a);if(!0==b.success)return b.data}catch(a){console.error("DeleteDeceasedMember error",a)}};return(0,b.jsx)(I.Provider,{value:{astro:P,user:J,planet:L,isAuthenticated:X,loading:Z,login:al,logout:ao,checkAuth:ah,switchProfile:ai,addProfile:aj,GetPlanet:ap,updateProfile:am,signUp:an,AstroLogic:ax,errors:_,clearErrors:af,mahadasha:T,Getmahadasha:aq,anthardahsa:V,getAntharDasha:ar,handleGoogleLogin:as,preditions:at,predictions:R,getJobsOptions:au,getEducationOptions:av,Getnavam:aw,navam:N,refreshAllData:ak,currentSubscription:ab,getCurrentSubscription:ay,getSubscriptionPackages:az,initiateSubscriptionPayment:aA,HandleFeedback:aB,GetFeedbackStatus:aC,DeleteDeceasedMember:aJ,GetSurveyStatus:aI,saveDeceasedFamily:aH,GetDeceasedFamily:aG,SaveSurveyAnswers:aF,GetUserSurveyAnswers:aE,GetSurveyQuestions:aD},children:a})},"useAuth",0,()=>{let a=(0,c.useContext)(I);if(!a)throw Error("useAuth must be used within AuthProvider");return a}],10918)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__70dee214._.js.map