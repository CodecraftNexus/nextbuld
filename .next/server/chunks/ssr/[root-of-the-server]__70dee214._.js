module.exports=[72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},27395,a=>{"use strict";let b="https://prediction.medi.lk",c=!1,d=[],e=(a,b=null)=>{d.forEach(c=>{a?c.reject(a):c.resolve(b)}),d=[]},f=async(a,f)=>{let g=await fetch(`${b}${a}`,{...f,credentials:"include",headers:{"Content-Type":"application/json",...f?.headers||{}}});if(401===g.status){if(c)return new Promise((a,b)=>{d.push({resolve:a,reject:b})}).then(c=>fetch(`${b}${a}`,{...f,headers:{...f?.headers,Authorization:`Bearer ${c}`}})).catch(a=>Promise.reject(a));c=!0;try{let c=await fetch(`${b}/api/auth/refresh`,{method:"POST",credentials:"include"});if(!c.ok)throw Error("Refresh failed");let d=await c.json(),g=d.access_token||d.accessToken;e(null,g);let h={...f,headers:{...f?.headers,Authorization:`Bearer ${g}`}};return fetch(`${b}${a}`,h)}catch(a){return e(a,null),Promise.reject(a)}finally{c=!1}}return g};a.s(["apiClient",0,{get:async(a,b)=>{let c=await f(a,{...b,method:"GET"}),d=await c.json();if(!c.ok)throw d;return d},post:async(a,b,c)=>{let d=await f(a,{...c,method:"POST",body:b?JSON.stringify(b):void 0}),e=await d.json();if(!d.ok)throw e;return e},put:async(a,b,c)=>{let d=await f(a,{...c,method:"PUT",body:b?JSON.stringify(b):void 0}),e=await d.json();if(!d.ok)throw e;return e},delete:async(a,b)=>{let c=await f(a,{...b,method:"DELETE"}),d=await c.json();if(!c.ok)throw d;return d}}])},10918,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(20094),f=a.i(27395);let g=async a=>{try{let b=a?`/api/profile?id=${a}`:"/api/profile",c=await f.apiClient.get(b);return{success:!0,user:c}}catch(a){return{success:!1,error:a.message}}},h=async a=>await f.apiClient.post("/api/auth/login",a),i=async a=>await f.apiClient.post("/api/auth/register",a),j=async a=>await f.apiClient.put("/api/profile",a),k=async()=>{try{await f.apiClient.post("/api/auth/logout")}catch(a){throw console.error("Logout error:",a),a}},l=async()=>{try{let a=await f.apiClient.post("/api/planethouse");return{success:!0,palentData:a}}catch(a){return{success:!1,error:a.message}}},m=async()=>{try{let a=await f.apiClient.post("/api/mahadasha");return{success:!0,MahadashaData:a}}catch(a){return{success:!1,error:a.message}}},n=async()=>{try{let a=await f.apiClient.post("/api/anthardasha");return{success:!0,AnthardashaData:a}}catch(a){return{success:!1,error:a.message}}},o=async a=>{try{let b=await f.apiClient.post("/api/auth/google-login",{idToken:a}),c=b?.requiresUsername;return{success:!0,user:b,requiresUsername:c}}catch(a){return{success:!1,error:a.message}}},p=async a=>{try{let b=await f.apiClient.post(`/api/prediction/${a}`);return{success:!0,predictions:b}}catch(a){return{success:!1,error:a.message}}},q=async()=>{try{let a=await f.apiClient.get("/api/jobs/options");return{success:!0,options:a}}catch(a){return{success:!1,error:a.message}}},r=async()=>{try{let a=await f.apiClient.get("/api/education/options");return{success:!0,options:a}}catch(a){return{success:!1,error:a.message}}},s=async a=>{try{let b=await f.apiClient.post("/api/profile/switch",{profileId:a});return b.token&&localStorage.setItem("auth_token",b.token),{success:!0,data:b}}catch(a){return console.error("Profile switch failed:",a),{success:!1,error:a.message}}},t=async(a,b)=>{try{let c=await f.apiClient.post("/api/addProfile",{name:a,nikname:b});return{success:!0,data:c}}catch(a){return console.error("Add profile failed:",a),{success:!1,error:a.message}}},u=async()=>{try{let a=await f.apiClient.post("/api/navam");return{success:!0,navamData:a}}catch(a){return{success:!1,error:a.message}}},v=async()=>{try{let a=await f.apiClient.post("/api/astrologic");return{success:!0,AstroData:a}}catch(a){return{success:!1,error:a.message}}},w=async()=>{try{let a=await f.apiClient.get("/api/subscription/packages");return{success:!0,packages:a}}catch(a){return{success:!1,error:a.message}}},x=async()=>{try{let a=await f.apiClient.get("/api/subscription/current");return{success:!0,subscription:a}}catch(a){return{success:!1,error:a.message}}},y=async(a,b)=>{try{let c=await f.apiClient.post("/api/subscription/initiate",{packageId:a,duration:b});return{success:!0,...c}}catch(a){return{success:!1,error:a.message}}},z=(0,c.createContext)(void 0);a.s(["AuthProvider",0,({children:a})=>{let f=(0,d.useRouter)(),[A,B]=(0,c.useState)(null),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)({}),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)(null),[O,P]=(0,c.useState)(null),[Q,R]=(0,c.useState)(!0),[S,T]=(0,c.useState)({}),[U,V]=(0,c.useState)(null),W=(0,c.useRef)(!1),X=(0,c.useRef)(0),Y=()=>T({}),Z=(0,c.useCallback)(async()=>{try{await ap(),await Promise.allSettled([l().then(a=>{a.success&&D(a.palentData)}),u().then(a=>{a.success&&F(a.navamData)}),m().then(a=>{a.success&&L(a.MahadashaData)}),n().then(a=>{a.success&&N(a.AnthardashaData)})])}catch(a){console.error("Error fetching all data:",a)}},[]),$=(0,c.useCallback)(async a=>{let b=Date.now();if(W.current)return void console.log("Auth check already in progress, skipping...");if(b-X.current<500)return void console.log("Auth check debounced");W.current=!0,X.current=b,R(!0);try{let b=await g(a);b.success&&b.user?(B(b.user),P(!0),await Z()):(B(null),P(!1),D(null),F(null),L(null),N(null),J({}))}catch(a){B(null),P(!1),D(null),F(null),L(null),N(null),J({})}finally{R(!1),W.current=!1}},[Z]),_=(0,c.useCallback)(async a=>{if(!a)return void e.toast.error("Invalid profile ID");R(!0);try{let b=await s(a);if(b.success)await $(),e.toast.success("Profile switched successfully");else throw Error(b.error||"Failed to switch profile")}catch(a){throw console.error("Profile switch error:",a),e.toast.error(a.message||"Failed to switch profile"),a}finally{R(!1)}},[$]),aa=(0,c.useCallback)(async(a,b)=>{if(!a||!b)return void e.toast.error("Name and nickname are required");R(!0);try{let c=await t(a,b);if(c.success)await $(),e.toast.success("Profile added successfully");else throw Error(c.error||"Failed to add profile")}catch(a){throw console.error("Add profile error:",a),e.toast.error(a.message||"Failed to add profile"),a}finally{R(!1)}},[$]),ab=(0,c.useCallback)(async()=>{if(O){R(!0);try{await Z()}finally{R(!1)}}},[O,Z]);(0,c.useEffect)(()=>{$(),Y()},[]),(0,c.useEffect)(()=>{let a,b=()=>{O&&!W.current&&(a=setTimeout(()=>{$()},5e3))};return window.addEventListener("focus",b),()=>{window.removeEventListener("focus",b),clearTimeout(a)}},[O]);let ac=async a=>{Y(),R(!0);try{await h(a),await $(),e.toast.success("Login Successful!"),f.push("/")}catch(b){let a=b.message||"Login failed. Please try again.";throw T({general:a}),e.toast.error(a),b}finally{R(!1)}},ad=async a=>{Y(),R(!0);try{await j(a),await $(),e.toast.success("Profile updated successfully")}catch(a){if(a.errors&&"object"==typeof a.errors)T(a.errors);else{let b=a.message||"Profile update failed";T({general:b}),e.toast.error(b)}throw a}finally{R(!1)}},ae=async a=>{Y(),R(!0);try{await i(a),e.toast.success("Account Created Successfully!")}catch(a){if(a.errors&&"object"==typeof a.errors)T(a.errors);else{let b=a.message||"Registration failed";T({general:b}),e.toast.error(b)}throw a}finally{R(!1)}},af=async()=>{try{await k(),B(null),D(null),F(null),L(null),N(null),J({}),P(!1),e.toast.info("Logged out successfully"),f.push("/auth")}catch(a){e.toast.error("Logout failed")}},ag=async()=>{try{R(!0);let a=await l();a.success?D(a.palentData):D(null)}catch(a){throw D(null),a}finally{R(!1)}},ah=async()=>{try{R(!0);let a=await m();a.success?L(a.MahadashaData):L(null)}catch(a){throw L(null),a}finally{R(!1)}},ai=async()=>{try{R(!0);let a=await n();a.success?N(a.AnthardashaData):N(null)}catch(a){throw N(null),a}finally{R(!1)}},aj=async a=>{R(!0),T({});try{let b=await o(a);if(b.requiresUsername)return{success:!0,requiresUsername:!0,user:b.user};return B(b?.user),await $(),{success:!0,requiresUsername:!1,user:b.user}}catch(a){throw T({general:a?.message||"Google login failed"}),a}finally{R(!1)}},ak=async a=>{try{let b=await p(a);J(c=>({...c,[a]:b.predictions}))}catch(a){return{success:!1,error:a.message}}},al=async()=>{try{let a=await q();if(a.success)return a.options;throw Error(a.error)}catch(a){throw a}},am=async()=>{try{let a=await r();if(a.success)return a.options;throw Error(a.error)}catch(a){throw a}},an=async()=>{try{R(!0);let a=await u();a.success?F(a.navamData):F(null)}catch(a){throw F(null),a}finally{R(!1)}},ao=async()=>{try{R(!0);let a=await v();a.success?H(a.AstroData):H(null)}catch(a){throw H(null),a}finally{R(!1)}},ap=async()=>{try{let a=await x();if(a.success)return V(a.subscription),a.subscription;return null}catch(a){return console.error("getCurrentSubscription error:",a),null}},aq=async()=>{try{let a=await w();if(a.success)return a.packages}catch(a){console.error("getSubscriptionPackages error:",a)}},ar=async(a,b)=>{try{let c=await y(a,b);if(c.success){let a=document.createElement("form");a.method="POST",a.action=c.payUrl,Object.entries(c.payData).forEach(([b,c])=>{let d=document.createElement("input");d.type="hidden",d.name=b,d.value=c,a.appendChild(d)}),document.body.appendChild(a),a.submit(),document.body.removeChild(a)}else throw Error(c.error)}catch(a){throw console.error("initiateSubscriptionPayment error:",a),a}};return(0,b.jsx)(z.Provider,{value:{astro:G,user:A,planet:C,isAuthenticated:O,loading:Q,login:ac,logout:af,checkAuth:$,switchProfile:_,addProfile:aa,GetPlanet:ag,updateProfile:ad,signUp:ae,AstroLogic:ao,errors:S,clearErrors:Y,mahadasha:K,Getmahadasha:ah,anthardahsa:M,getAntharDasha:ai,handleGoogleLogin:aj,preditions:ak,predictions:I,getJobsOptions:al,getEducationOptions:am,Getnavam:an,navam:E,refreshAllData:ab,currentSubscription:U,getCurrentSubscription:ap,getSubscriptionPackages:aq,initiateSubscriptionPayment:ar},children:a})},"useAuth",0,()=>{let a=(0,c.useContext)(z);if(!a)throw Error("useAuth must be used within AuthProvider");return a}],10918)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__70dee214._.js.map